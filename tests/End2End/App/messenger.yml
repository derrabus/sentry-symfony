services:
  _defaults:
    autoconfigure: true

  Sentry\SentryBundle\Tests\End2End\App\Messenger\StaticInMemoryTransportFactory:
    class: \Sentry\SentryBundle\Tests\End2End\App\Messenger\StaticInMemoryTransportFactory

  Sentry\SentryBundle\Tests\End2End\App\Messenger\FooMessageHandler:
    class: \Sentry\SentryBundle\Tests\End2End\App\Messenger\FooMessageHandler

  Sentry\SentryBundle\Tests\End2End\App\Messenger\SyncMessageHandler:
    class: \Sentry\SentryBundle\Tests\End2End\App\Messenger\SyncMessageHandler

  Sentry\SentryBundle\Tests\End2End\App\Controller\MessengerController:
    autowire: true
    tags:
      - controller.service_arguments

framework:
  messenger:
    transports:
      sync:
        dsn: 'sync://'
      async:
        dsn: 'static://'
        retry_strategy:
          max_retries: 1
    routing:
      '\Sentry\SentryBundle\Tests\End2End\App\Messenger\FooMessage': async
      '\Sentry\SentryBundle\Tests\End2End\App\Messenger\SyncMessage': sync

sentry:
  messenger:
    capture_soft_fails: false
